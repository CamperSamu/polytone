ported back all new recent features